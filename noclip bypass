local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Noclip Bypass",
    LoadingTitle = "Noclip Bypass",
    LoadingSubtitle = "by Colin",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "NoclipBypass", 
        FileName = "Config"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvite",
        RememberJoins = true
    },
    KeySystem = false,
})

local MainTab = Window:CreateTab("Main", 4483362458)
local BypassTab = Window:CreateTab("Bypass", 4483362458)

getgenv().Noclip = {
    Active = false,
    Connections = {}
}

local NoclipToggle = MainTab:CreateToggle({
    Name = "Enable Noclip",
    CurrentValue = false,
    Flag = "NoclipEnabled",
    Callback = function(Value)
        if Value then
            StartNoclip()
        else
            StopNoclip()
        end
    end,
})

local NoclipKeybind = MainTab:CreateKeybind({
    Name = "Noclip Keybind",
    CurrentKeybind = "N",
    HoldToInteract = false,
    Flag = "NoclipKeybind",
    Callback = function(Key)
        getgenv().NoclipKey = Key
    end,
})

local MethodDropdown = BypassTab:CreateDropdown({
    Name = "Bypass Method",
    Options = {"CFrame", "Network", "Anchor", "MultiMethod"},
    CurrentOption = "MultiMethod",
    Flag = "BypassMethod",
    Callback = function(Option)
        getgenv().BypassMethod = Option
    end,
})

local AntiTPToggle = BypassTab:CreateToggle({
    Name = "Anti-Teleport Back",
    CurrentValue = true,
    Flag = "AntiTPEnabled",
    Callback = function(Value)
        getgenv().AntiTP = Value
        if Value then
            SetupAntiTP()
        end
    end,
})

function StartNoclip()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local RunService = game:GetService("RunService")
    
    local character = LocalPlayer.Character
    if not character then return end
    
    getgenv().Noclip.Active = true
    
    local method = getgenv().BypassMethod or "MultiMethod"
    
    if method == "CFrame" or method == "MultiMethod" then
        EnableCFrameNoclip()
    end
    
    if method == "Network" or method == "MultiMethod" then
        EnableNetworkBypass()
    end
    
    if method == "Anchor" or method == "MultiMethod" then
        EnableAnchorBypass()
    end
    
    Rayfield:Notify({
        Title = "Noclip Activated",
        Content = "Using method: " .. method,
        Duration = 3
    })
end

function StopNoclip()
    getgenv().Noclip.Active = false
    
    for _, connection in pairs(getgenv().Noclip.Connections) do
        if connection then
            connection:Disconnect()
        end
    end
    
    getgenv().Noclip.Connections = {}
    
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local character = LocalPlayer.Character
    
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
                if part:FindFirstChild("NoclipAnchor") then
                    part.Anchored = false
                end
            end
        end
    end
end

function EnableCFrameNoclip()
    local RunService = game:GetService("RunService")
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    
    local connection = RunService.Stepped:Connect(function()
        if not getgenv().Noclip.Active then return end
        
        local character = LocalPlayer.Character
        if not character then return end
        
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
                
                if getgenv().AntiTP then
                    local rayOrigin = part.Position
                    local rayDirection = part.CFrame.LookVector * 2
                    local raycastParams = RaycastParams.new()
                    raycastParams.FilterDescendantsInstances = {character}
                    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
                    
                    local rayResult = workspace:Raycast(rayOrigin, rayDirection, raycastParams)
                    
                    if rayResult then
                        local normal = rayResult.Normal
                        local offset = normal * 0.1
                        part.CFrame = part.CFrame + offset
                    end
                end
            end
        end
    end)
    
    table.insert(getgenv().Noclip.Connections, connection)
end

function EnableNetworkBypass()
    local RunService = game:GetService("RunService")
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    
    local connection = RunService.Heartbeat:Connect(function()
        if not getgenv().Noclip.Active then return end
        
        local character = LocalPlayer.Character
        if not character then return end
        
        local rootPart = character:FindFirstChild("HumanoidRootPart")
        if not rootPart then return end
        
        if not rootPart:IsNetworkOwner() then
            pcall(function()
                rootPart:SetNetworkOwner(nil)
                rootPart:SetNetworkOwner(LocalPlayer)
            end)
        end
    end)
    
    table.insert(getgenv().Noclip.Connections, connection)
end

function EnableAnchorBypass()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    
    local character = LocalPlayer.Character
    if not character then return end
    
    for _, part in pairs(character:GetDescendants()) do
        if part:IsA("BasePart") then
            local anchor = Instance.new("BoolValue")
            anchor.Name = "NoclipAnchor"
            anchor.Value = part.Anchored
            anchor.Parent = part
            
            part.Anchored = true
        end
    end
end

function SetupAntiTP()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local RunService = game:GetService("RunService")
    
    local lastPosition = nil
    
    local connection = RunService.Heartbeat:Connect(function()
        if not getgenv().AntiTP then return end
        
        local character = LocalPlayer.Character
        if not character then return end
        
        local rootPart = character:FindFirstChild("HumanoidRootPart")
        if not rootPart then return end
        
        local currentPosition = rootPart.Position
        
        if lastPosition then
            local distance = (currentPosition - lastPosition).Magnitude
            
            if distance > 100 then
                rootPart.CFrame = CFrame.new(lastPosition)
            end
        end
        
        lastPosition = currentPosition
    end)
    
    table.insert(getgenv().Noclip.Connections, connection)
end

local UIS = game:GetService("UserInputService")
UIS.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode[getgenv().NoclipKey or "N"] then
        NoclipToggle:Set(not getgenv().Noclip.Active)
    end
end)

getgenv().NoclipKey = "N"
getgenv().BypassMethod = "MultiMethod"
getgenv().AntiTP = true

Rayfield:Notify({
    Title = "Noclip Bypass Loaded",
    Content = "Press " .. getgenv().NoclipKey .. " to toggle noclip",
    Duration = 5,
})
