-- == Hitbox Extender for Roblox ==
-- Author: Colin
-- Description: Extend hitbox for weapons and bare hands with Rayfield UI

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Hitbox Extender Pro",
    LoadingTitle = "Hitbox Extender",
    LoadingSubtitle = "by Colin",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "HitboxExtender",
        FileName = "Config"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvite",
        RememberJoins = true
    },
    KeySystem = false,
})

local MainTab = Window:CreateTab("Main Features", 4483362458)
local VisualsTab = Window:CreateTab("Visuals", 4483362458)
local SettingsTab = Window:CreateTab("Settings", 4483362458)

-- A. MAIN HITBOX SETTINGS
local HitboxSection = MainTab:CreateSection("Hitbox Configuration")

local HitboxSize = MainTab:CreateSlider({
    Name = "Hitbox Size Multiplier",
    Range = {1, 10},
    Increment = 0.1,
    Suffix = "x",
    CurrentValue = 1,
    Flag = "HitboxSize",
    Callback = function(Value)
        getgenv().HitboxMultiplier = Value
    end,
})

local HitboxType = MainTab:CreateDropdown({
    Name = "Hitbox Target",
    Options = {"All Players", "Enemies Only", "Teammates Only", "Specific Player"},
    CurrentOption = "All Players",
    Flag = "HitboxTarget",
    Callback = function(Option)
        getgenv().HitboxTarget = Option
    end,
})

local WeaponHitbox = MainTab:CreateToggle({
    Name = "Extend Weapon Hitbox",
    CurrentValue = false,
    Flag = "WeaponHitbox",
    Callback = function(Value)
        getgenv().WeaponHitboxEnabled = Value
    end,
})

local FistHitbox = MainTab:CreateToggle({
    Name = "Extend Fist Hitbox",
    CurrentValue = false,
    Flag = "FistHitbox",
    Callback = function(Value)
        getgenv().FistHitboxEnabled = Value
    end,
})

-- B. VISUAL SETTINGS
local VisualSection = VisualsTab:CreateSection("Visual Configuration")

local ShowHitbox = VisualsTab:CreateToggle({
    Name = "Show Hitbox Visual",
    CurrentValue = false,
    Flag = "ShowHitbox",
    Callback = function(Value)
        getgenv().ShowHitboxVisual = Value
    end,
})

local HitboxColor = VisualsTab:CreateColorPicker({
    Name = "Hitbox Color",
    Color = Color3.fromRGB(255, 0, 0),
    Flag = "HitboxColor",
    Callback = function(Color)
        getgenv().HitboxVisualColor = Color
    end
})

-- C. MAIN HITBOX EXTENSION FUNCTION
function ExtendHitbox()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local RunService = game:GetService("RunService")
    
    -- Hitbox extension variables
    getgenv().HitboxMultiplier = getgenv().HitboxMultiplier or 1
    getgenv().HitboxTarget = getgenv().HitboxTarget or "All Players"
    getgenv().WeaponHitboxEnabled = getgenv().WeaponHitboxEnabled or false
    getgenv().FistHitboxEnabled = getgenv().FistHitboxEnabled or false
    getgenv().ShowHitboxVisual = getgenv().ShowHitboxVisual or false
    getgenv().HitboxVisualColor = getgenv().HitboxVisualColor or Color3.fromRGB(255, 0, 0)
    
    -- Main hitbox extension loop
    local HitboxConnection
    HitboxConnection = RunService.Heartbeat:Connect(function()
        if not getgenv().HitboxEnabled then
            HitboxConnection:Disconnect()
            return
        end
        
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                local character = player.Character
                if character and character:FindFirstChild("Humanoid") and character.Humanoid.Health > 0 then
                    
                    -- Check target filtering
                    local shouldExtend = false
                    if getgenv().HitboxTarget == "All Players" then
                        shouldExtend = true
                    elseif getgenv().HitboxTarget == "Enemies Only" then
                        -- Add team check logic here based on game
                        shouldExtend = true -- Placeholder
                    elseif getgenv().HitboxTarget == "Teammates Only" then
                        -- Add team check logic here
                        shouldExtend = true -- Placeholder
                    end
                    
                    if shouldExtend then
                        -- Extend head hitbox
                        local head = character:FindFirstChild("Head")
                        if head then
                            local originalSize = head.Size
                            head.Size = originalSize * getgenv().HitboxMultiplier
                            
                            -- Visual hitbox
                            if getgenv().ShowHitboxVisual and not head:FindFirstChild("HitboxVisual") then
                                local hitboxVisual = Instance.new("BoxHandleAdornment")
                                hitboxVisual.Name = "HitboxVisual"
                                hitboxVisual.Adornee = head
                                hitboxVisual.AlwaysOnTop = true
                                hitboxVisual.ZIndex = 10
                                hitboxVisual.Size = head.Size
                                hitboxVisual.Transparency = 0.7
                                hitboxVisual.Color3 = getgenv().HitboxVisualColor
                                hitboxVisual.Parent = head
                            end
                        end
                        
                        -- Extend weapon hitboxes
                        if getgenv().WeaponHitboxEnabled then
                            for _, tool in pairs(character:GetChildren()) do
                                if tool:IsA("Tool") then
                                    local handle = tool:FindFirstChild("Handle")
                                    if handle then
                                        handle.Size = handle.Size * getgenv().HitboxMultiplier
                                    end
                                end
                            end
                        end
                        
                        -- Extend fist hitboxes
                        if getgenv().FistHitboxEnabled then
                            local leftArm = character:FindFirstChild("LeftHand") or character:FindFirstChild("LeftArm")
                            local rightArm = character:FindFirstChild("RightHand") or character:FindFirstChild("RightArm")
                            
                            if leftArm then
                                leftArm.Size = leftArm.Size * getgenv().HitboxMultiplier
                            end
                            if rightArm then
                                rightArm.Size = rightArm.Size * getgenv().HitboxMultiplier
                            end
                        end
                    end
                end
            end
        end
    end)
end

-- D. TOGGLE MAIN FUNCTION
local ToggleHitbox = MainTab:CreateToggle({
    Name = "Enable Hitbox Extender",
    CurrentValue = false,
    Flag = "HitboxEnabled",
    Callback = function(Value)
        getgenv().HitboxEnabled = Value
        if Value then
            ExtendHitbox()
            Rayfield:Notify({
                Title = "Hitbox Extender",
                Content = "Hitbox extender activated!",
                Duration = 3,
                Image = 4483362458
            })
        else
            -- Reset all hitboxes when disabled
            for _, player in pairs(game:GetService("Players"):GetPlayers()) do
                local character = player.Character
                if character then
                    local head = character:FindFirstChild("Head")
                    if head then
                        head.Size = Vector3.new(2, 1, 1) -- Default head size
                        local visual = head:FindFirstChild("HitboxVisual")
                        if visual then
                            visual:Destroy()
                        end
                    end
                end
            end
        end
    end,
})

-- E. PRESET SETTINGS
local PresetSection = SettingsTab:CreateSection("Quick Presets")

SettingsTab:CreateButton({
    Name = "Small Hitbox (2x)",
    Callback = function()
        HitboxSize:Set(2)
        Rayfield:Notify({
            Title = "Preset Applied",
            Content = "Small hitbox preset activated",
            Duration = 2
        })
    end,
})

SettingsTab:CreateButton({
    Name = "Medium Hitbox (4x)",
    Callback = function()
        HitboxSize:Set(4)
        Rayfield:Notify({
            Title = "Preset Applied",
            Content = "Medium hitbox preset activated",
            Duration = 2
        })
    end,
})

SettingsTab:CreateButton({
    Name = "Large Hitbox (6x)",
    Callback = function()
        HitboxSize:Set(6)
        Rayfield:Notify({
            Title = "Preset Applied",
            Content = "Large hitbox preset activated",
            Duration = 2
        })
    end,
})

-- F. INITIALIZE SCRIPT
Rayfield:Notify({
    Title = "Hitbox Extender Loaded",
    Content = "Script successfully loaded! Configure your settings.",
    Duration = 5,
    Image = 4483362458
})

-- Auto-execute when script starts
getgenv().HitboxEnabled = false
getgenv().HitboxMultiplier = 1
