-- Load WindUI Library
local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/dy1zn4t/bmF0dWk-/refs/heads/main/ui.lua"))()

-- Create Window exactly like WindUI
local Window = WindUI:CreateWindow({
    Title = "dor dor",
    Icon = "rbxassetid://113216930555884",
    Author = "axel", 
    Folder = "SurvivalConfig",
    Size = UDim2.fromOffset(580, 460),
    LiveSearchDropdown = true,
    AutoSave = true,
    FileSaveName = "Survival Config.json",
})

-- Create Tabs exactly like WindUI
local Tabs = {
    Combat = Window:Tab({Title = "Combat", Icon = "crosshair", Desc = "RageBot and combat settings"}),
    Visuals = Window:Tab({Title = "Visuals", Icon = "eye", Desc = "ESP and visual features"}),
    Performance = Window:Tab({Title = "Performance", Icon = "zap", Desc = "Performance optimization"}),
    Divider1 = Window:Divider(),
    Info = Window:Tab({Title = "Information", Icon = "info", Desc = "Script info and credits"}),
}

-- Select first tab
Window:SelectTab(1)

-- Combat Tab Sections
Tabs.Combat:Section({Title = "RageBot Settings"})

Tabs.Combat:Paragraph{
    Title = "Survival Protocol",
    Desc = "No ethics, just survival. We need these tools to live."
}

local RageToggle = Tabs.Combat:Toggle({
    Title = "Enable RageBot",
    Default = false,
    Callback = function(state)
        getgenv().RagebotEnabled = state
    end
})

local AimDropdown = Tabs.Combat:Dropdown({
    Title = "Aim Part",
    Values = {"Head", "UpperTorso", "LowerTorso", "HumanoidRootPart", "Random"},
    Value = "Head",
    Callback = function(option)
        getgenv().AimPart = option
    end
})

local SmoothSlider = Tabs.Combat:Slider({
    Title = "Aim Smoothing",
    Step = 1,
    Value = {Min = 1, Max = 20, Default = 5},
    Callback = function(value)
        getgenv().AimSmoothing = value
    end
})

Tabs.Combat:Section({Title = "FOV Settings"})

local FOVToggle = Tabs.Combat:Toggle({
    Title = "Show FOV Circle", 
    Default = true,
    Callback = function(state)
        getgenv().ShowFOV = state
        updateFOVCircle()
    end
})

local FOVSlider = Tabs.Combat:Slider({
    Title = "FOV Size",
    Step = 10,
    Value = {Min = 50, Max = 300, Default = 120},
    Callback = function(value)
        getgenv().FOVSize = value
        updateFOVCircle()
    end
})

-- Visuals Tab
Tabs.Visuals:Section({Title = "ESP Settings"})

local ESPToggle = Tabs.Visuals:Toggle({
    Title = "Enable ESP",
    Default = false,
    Callback = function(state)
        getgenv().ESPEnabled = state
        if state then
            createESP()
        else
            removeESP()
        end
    end
})

local TracerToggle = Tabs.Visuals:Toggle({
    Title = "Enable Tracers",
    Default = false,
    Callback = function(state)
        getgenv().TracerEnabled = state
        if state then
            createTracers()
        else
            removeTracers()
        end
    end
})

-- Performance Tab  
Tabs.Performance:Section({Title = "Optimization"})

local RenderToggle = Tabs.Performance:Toggle({
    Title = "Disable Rendering",
    Default = false,
    Callback = function(state)
        getgenv().DisableRendering = state
        toggleRendering()
    end
})

local AntiLagToggle = Tabs.Performance:Toggle({
    Title = "Anti-Lag Mode",
    Default = false,
    Callback = function(state)
        getgenv().AntiLag = state
        toggleAntiLag()
    end
})

-- Info Tab
Tabs.Info:Section({Title = "uhh"})

Tabs.Info:Paragraph{
    Title = "ihhh",
    Desc = "ahhh"
}

Tabs.Info:Code({
    Title = "prikitiw",
    Code = [[
-- ahh
]]
})

Tabs.Info:Button({
    Title = "Test Notification",
    Callback = function()
        WindUI:Notify({
            Title = "tembak",
            Content = "dor dor",
            Icon = "alert-triangle", 
            Duration = 5,
        })
    end
})

-- Lock/Unlock system like WindUI example
Tabs.Info:Section({Title = "Safety Controls"})

local LockedToggle = Tabs.Info:Toggle({
    Title = "Safety Lock",
    Icon = "lock",
    Default = true,
    Locked = true,
    Callback = function(state)
        print("Safety lock:", state)
    end
})

Tabs.Info:Toggle({
    Title = "Toggle Safety",
    Icon = "check", 
    Default = true,
    Callback = function(state)
        if state == false then
            LockedToggle:Unlock()
            LockedToggle:SetTitle("Safety Unlocked")
        else
            LockedToggle:Lock()
            LockedToggle:SetTitle("Safety Locked") 
        end
    end
})

-- Backend systems (same as before)
local FOVCircle = nil
local screenCenter = Vector2.new()

function createFOVCircle()
    if FOVCircle then FOVCircle:Remove() end
    
    FOVCircle = Drawing.new("Circle")
    FOVCircle.Visible = getgenv().ShowFOV or true
    FOVCircle.Color = Color3.fromRGB(0, 255, 0)
    FOVCircle.Thickness = 2
    FOVCircle.NumSides = 32
    FOVCircle.Radius = getgenv().FOVSize or 120
    FOVCircle.Filled = false
    FOVCircle.Transparency = 0.5
    
    local viewportSize = workspace.CurrentCamera.ViewportSize
    screenCenter = Vector2.new(viewportSize.X / 2, viewportSize.Y / 2)
    FOVCircle.Position = screenCenter
    
    game:GetService("RunService").RenderStepped:Connect(function()
        if FOVCircle then
            FOVCircle.Visible = getgenv().ShowFOV or true
            FOVCircle.Position = screenCenter
        end
    end)
end

function updateFOVCircle()
    if FOVCircle then
        FOVCircle.Visible = getgenv().ShowFOV or true
        FOVCircle.Radius = getgenv().FOVSize or 120
    end
end

-- RageBot functions
function getAimPart(character)
    local aimPart = getgenv().AimPart or "Head"
    if aimPart == "Random" then
        local parts = {"Head", "UpperTorso", "LowerTorso", "HumanoidRootPart"}
        aimPart = parts[math.random(1, #parts)]
    end
    return character:FindFirstChild(aimPart) or character:FindFirstChild("HumanoidRootPart")
end

function findBestTarget()
    if not game.Players.LocalPlayer.Character then return nil end
    local localRoot = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not localRoot then return nil end
    
    local bestTarget = nil
    local closestDistance = getgenv().FOVSize or 120
    
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character then
            local character = player.Character
            local humanoid = character:FindFirstChild("Humanoid")
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            
            if humanoid and humanoid.Health > 0 and rootPart then
                local screenPoint, onScreen = workspace.CurrentCamera:WorldToViewportPoint(rootPart.Position)
                if onScreen then
                    local distanceFromCenter = (Vector2.new(screenPoint.X, screenPoint.Y) - screenCenter).Magnitude
                    if distanceFromCenter <= closestDistance then
                        closestDistance = distanceFromCenter
                        bestTarget = player
                    end
                end
            end
        end
    end
    
    return bestTarget
end

function smoothAim(targetPosition)
    local camera = workspace.CurrentCamera
    local currentCFrame = camera.CFrame
    local targetCFrame = CFrame.lookAt(currentCFrame.Position, targetPosition)
    local smoothing = getgenv().AimSmoothing or 5
    return currentCFrame:Lerp(targetCFrame, 1/smoothing)
end

function rageBotAim()
    if not getgenv().RagebotEnabled then return end
    local target = findBestTarget()
    if target and target.Character then
        local aimPart = getAimPart(target.Character)
        if aimPart then
            workspace.CurrentCamera.CFrame = smoothAim(aimPart.Position)
        end
    end
end

-- ESP System
local ESPObjects = {}

function createESP()
    removeESP()
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            setupPlayerESP(player)
        end
    end
end

function setupPlayerESP(player)
    local function createESPForCharacter(character)
        local highlight = Instance.new("Highlight")
        highlight.Name = "ESP_" .. player.Name
        highlight.Adornee = character
        highlight.Parent = game.CoreGui
        highlight.FillColor = Color3.fromRGB(255, 0, 0)
        highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
        highlight.FillTransparency = 0.4
        highlight.OutlineTransparency = 0
        ESPObjects[player.Name] = highlight
    end
    
    if player.Character then createESPForCharacter(player.Character) end
    player.CharacterAdded:Connect(createESPForCharacter)
end

function removeESP()
    for name, highlight in pairs(ESPObjects) do
        if highlight then highlight:Destroy() end
    end
    ESPObjects = {}
end

-- Performance systems
local RenderingConnection = nil

function toggleRendering()
    if RenderingConnection then
        RenderingConnection:Disconnect()
        RenderingConnection = nil
    end
    
    if getgenv().DisableRendering then
        RenderingConnection = game:GetService("RunService").RenderStepped:Connect(function()
            game:GetService("RunService"):Set3dRenderingEnabled(false)
        end)
    else
        game:GetService("RunService"):Set3dRenderingEnabled(true)
    end
end

function toggleAntiLag()
    if getgenv().AntiLag then
        setGraphicsQuality(1)
        game:GetService("Lighting").GlobalShadows = false
    else
        setGraphicsQuality(7)
        game:GetService("Lighting").GlobalShadows = true
    end
end

function setGraphicsQuality(level)
    local settings = game:GetService("UserGameSettings")
    settings:SetQualityLevel(level)
end

-- Main loop
game:GetService("RunService").RenderStepped:Connect(rageBotAim)

-- Initialize
createFOVCircle()
